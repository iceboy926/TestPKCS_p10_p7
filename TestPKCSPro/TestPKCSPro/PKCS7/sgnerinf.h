

#ifndef _SIGNERINFO_H__
#define _SIGNERINFO_H__


#define digest_md5_a	1
#define digest_sha1_a	2
#define digest_sha256_a	3
#define digest_sha384_a	4
#define digest_sha512_a	5
#define digest_sm3_a	6

#define _signer_memory_	0xe1
#define _signer_encode_	0xe2
#define _signer_io_		0xe3
#define _signer_algo_		0xe4
#define _signer_id_		0xe5


#ifdef __cplusplus
extern "C" {
#endif


#include "sgncer.h"


static unsigned char _oid_md5[14]={
	0x30,0x0c,0x06,0x08,0x2A,
	0x86,0x48,0x86,0xF7,0x0D,
	0x02,0x05,0x05,0x00};

static unsigned char _oid_sha1[11] ={
	0x30,0x09,0x06,0x05,0x2B,
	0x0E,0x03,0x02,0x1A,0x05,
	0x00};
static unsigned char _oid_sha256[15] = {
	0x30,0x0d,0x06,0x09,0x60,
	0x86,0x48,0x01,0x65,0x03,
	0x04,0x02,0x01,0x05,0x00};

static unsigned char _oid_sha224[15] ={
	0x30,0x0d,0x06,0x09,0x60,
	0x86,0x48,0x01,0x65,0x03,
	0x04,0x02,0x04,0x05,0x00};

static unsigned char _oid_rsaEncrypt[15]= {
	0x30,0x0d,0x06,0x09,0x2A,
	0x86,0x48,0x86,0xF7,0x0D,
	0x01,0x01,0x01,0x05,0x00};
   
static unsigned char _oid_rsaSign[15]= {
    0x30,0x0d,0x06,0x09,0x2A,
    0x86,0x48,0x86,0xF7,0x0D,
    0x01,0x01,0x01,0x05,0x00};

static unsigned char _oid_sha384[15] =	{
	0x30, 0x0d, 0x06, 0x09, 0x60, 0x86,
	0x48, 0x01, 0x65, 0x03, 0x04, 0x02,
	0x02, 0x05, 0x00};

static unsigned char _oid_sha512[15] =	{
	0x30, 0x0d, 0x06, 0x09, 0x60, 0x86,
	0x48, 0x01, 0x65, 0x03, 0x04, 0x02,
	0x03, 0x05, 0x00};

//1.2.156.10197.1.401
static unsigned char _oid_sm3[14] = {
	0x30,0x0c,0x06,0x08,0x2a,0x81,0x1c,
	0xcf,0x55,0x01,0x83,0x11,0x05,0x00
};

//static unsigned char _oid_sm2_sign[14] = {
//	0x30,0x0c,0x06,0x08,0x2a,0x81,0x1c,
//	0xcf,0x55,0x01,0x82,0x2d,0x05,0x00
//};

//1.2.156.10197.1.501
static unsigned char _oid_sm2_sm3[14] = {
	0x30,0x0c,0x06,0x08,0x2a,0x81,0x1c,
	0xcf,0x55,0x01,0x83,0x75,0x05,0x00
};

//1.2.156.10197.1.301.1
static unsigned char _oid_sm2_sign[15] = {
    0x30,0x0D,0x06,0x09,0x2A,0x81,0x1C,0xCF,0x55,0x01,0x82,0x2D,0x01,0x05,0x00
};

// static unsigned char _oid_sm2Encrypt[21] = {
// 	0x30,0x13,0x06,0x07,0x2a,0x86,0x48,
// 	0xce,0x3d,0x02,0x01,0x06,0x08,0x2a,
// 	0x81,0x1c,0xcf,0x55,0x01,0x82,0x2d
// };

////1.2.156.10197.1.301.3
static unsigned char _oid_sm2Encrypt[15] = {
    0x30,0x0D,0x06,0x09,0x2A,0x81,0x1C,0xCF,0x55,0x01,0x82,0x2D,0x03,0x05,0x00
};

    
int signerInfo_adjustLen( int inputLen);

//
int signerInfo_Encode(unsigned char ** buf, int buflen);

//
int signerInfo_SetCert(unsigned char * dCert,int  dLen);
int signerInfo_GetCert(unsigned char * dCert,int  dLen);


//
int signerInfo_GetDigestAlgo(void);
int signerInfo_SetDigestAlgo(int algo);

//
int signerInfo_SetSigned(unsigned char * sSign,int  sLen);
int signerInfo_GetSigned(unsigned char * sSign,int  sLen);
    
int signerInfo_GetCertLen();


#ifdef __cplusplus
}
#endif

#endif
